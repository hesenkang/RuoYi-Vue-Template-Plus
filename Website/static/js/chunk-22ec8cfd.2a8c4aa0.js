(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22ec8cfd"],{"2d57":function(t,e,n){"use strict";n("c034")},"36da":function(t,e,n){},"62c5":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"container"},[n("el-table",t._g(t._b({directives:[{name:"show",rawName:"v-show",value:t.showColumnViews.length>0,expression:"showColumnViews.length > 0"}],ref:"table",attrs:{height:t.$attrs.height?t.$attrs.height:"60vh",data:t.tableData,border:!0,"tooltip-effect":"light"}},"el-table",t.$attrs,!1),t.$listeners),[t._l(t.showColumnViews,(function(e,o){return[t.checkable&&t.selectionIndex===o?n("el-table-column",{key:o,attrs:{prop:"_selection",type:"selection",width:t.selectionWidth,fixed:e.fixed}}):t._e(),e.components||e.isOperate?n("el-table-column",{key:o+":"+e.field+":"+e.components,attrs:{prop:e.field,type:e.type,label:e.label,align:e.isOperate?"center":e.align,width:e.width,fixed:e.fixed},scopedSlots:t._u([{key:"default",fn:function(n){return[t._t("default",null,{item:e,colunmIndex:o,data:n})]}}],null,!0)}):n("el-table-column",{key:o+":"+e.field,attrs:{prop:e.field,type:e.isOperate?"":"default",label:e.label,sortable:!!e.sortable&&"custom",align:e.isOperate?"center":e.align,width:e.width,fixed:e.fixed}})]}))],2)],1)},a=[],i=(n("a9e3"),{props:{columns:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},checkable:{type:Boolean,default:!1},selectionWidth:{type:Number,default:40},selectionIndex:{type:Number,default:0}},data:function(){return{}},computed:{showColumnViews:function(){return this.columns}}}),r=i,l=(n("2d57"),n("2877")),s=Object(l["a"])(r,o,a,!1,null,"543a18da",null);e["a"]=s.exports},"74e6":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"container"},[t.buttonTopsItems.length>0?n("section",{staticClass:"buttons_top"},t._l(t.buttonTopsItems,(function(e){return n("el-button",t._b({key:e.field,on:{click:function(n){return t.handelTopButtonClick(e)}}},"el-button",Object.assign({},e.props),!1),[t._v(t._s(e.label))])})),1):t._e(),n("HeBaseTable",t._b({attrs:{columns:t.columns,tableData:t.tableData}},"HeBaseTable",Object.assign({},t.props),!1)),t.modal.isShow?n("HeEditModal",t._b({directives:[{name:"show",rawName:"v-show",value:t.modal.isShow,expression:"modal.isShow"}],attrs:{isShow:t.modal.isShow},on:{"update:isShow":function(e){return t.$set(t.modal,"isShow",e)},"update:is-show":function(e){return t.$set(t.modal,"isShow",e)},submit:t.submitEditForm}},"HeEditModal",Object.assign({},{modal:t.modal},t.modal),!1)):t._e()],1)},a=[],i=n("5530"),r=n("53ca"),l=(n("d9e2"),n("99af"),n("4de4"),n("7db0"),n("d81d"),n("14d9"),n("b0c0"),n("d3b7"),n("25f0"),n("3ca3"),n("159b"),n("ddb0"),n("b775")),s=n("8fe1"),u=n("62c5"),c=function(t){if(!t)return console.error("getTableColumns 返回数据为: ",t),[];var e=function(t){return null!==t&&"object"===Object(r["a"])(t)&&"[object Object]"===Object.prototype.toString.call(t)&&!Array.isArray(t)};if(!e(t))return console.error("getTableColumns 返回数据为: ",t),[];var n=t.list||t.rows||t.rawData||t;return n&&Array.isArray(n)?n:(console.error("getTableColumns 解析列表数据为: ",n),[])},d={components:{HeBaseTable:u["a"],HeEditModal:function(){return Promise.all([n.e("chunk-elementUI"),n.e("chunk-commons"),n.e("chunk-7c706c2f")]).then(n.bind(null,"39ba"))}},props:{value:{type:Array,default:function(){return[]}},buttonsCfg:{type:Object,default:function(){return{}}},columnsCfg:{type:Object,require:!0,default:function(){return{}}},props:{type:Object,default:function(){return{}}}},data:function(){return{buttons:[],columns:[],tableData:[],modal:{isShow:!1}}},watch:{value:function(t){var e=t;if(this.columns.length>0){var n=this.columns.some((function(t){return t.options}));n&&(e=Object(s["a"])(this.columns,e))}this.tableData=e}},computed:{buttonTopsItems:function(){return this.buttonItems.filter((function(t){return"top"===t.showMode}))},buttonItems:function(){var t=this.buttons||null;return Array.isArray(t)?t:[]}},created:function(){this.getTableButtons(),this.getTableColumns(),this.tableData=this.value},methods:{submitEditForm:function(t){var e=this,n=t.button,o=t.form,a=this.tableData.find((function(t){return t.id===o.id}));if(a)this.$message({type:"warning",message:"该条数据已存在!"});else{var r=Object(i["a"])({},o),s={url:"/energy/meter/notUserMeterList",method:"get",params:{id:r.id,meterType:n.meterType,pageNum:1,pageSize:9999}};Object(l["a"])(s).then((function(t){var n=t||{},o=n.code,a=n.data,l=a[0];200===o&&(e.tableData.push(Object(i["a"])({roomName:l.roomName,name:l.name,unit:l.unit,meterType:l.meterType},r)),e.$emit("input",e.tableData),e.modal.isShow=!1)}))}},handleAdd:function(t){var e=t.modal;this.modal=Object(i["a"])(Object(i["a"])({},e),{},{button:t}),this.modal.isShow=!0},handelTopButtonClick:function(t){var e,n=t.label,o=t.type,a=t.apiCfg,i=t.modal,r=Boolean(null===a||void 0===a||null===(e=a.config)||void 0===e?void 0:e.url);if(!r)throw new Error("按钮[ ".concat(n,": ").concat(o," ]未正确配置, 缺少请求Api!"));if("Add"!==o)throw new Error("按钮[ ".concat(n,": ").concat(o," ]未开发的功能！"));if(!i)throw new Error("按钮[ ".concat(n,": ").concat(o," ]未正确配置, 缺少弹窗配置！"));this.handleAdd(t)},getTableButtons:function(){var t,e,n=this,o=Boolean(null===(t=this.buttonsCfg)||void 0===t||null===(t=t.apiCfg)||void 0===t||null===(t=t.config)||void 0===t?void 0:t.url),a=(null===(e=this.buttonsCfg)||void 0===e?void 0:e.data)&&Array.isArray(this.buttonsCfg.data);o?Object(l["a"])(this.buttonsCfg.apiCfg.config).then((function(t){var e=t.code,o=t.rows;if(200===e){var a=o||t.list||t.data||[],i=a.map((function(t){var e=$HE.deepClone(n.buttonsCfg.data[0]);return e.label="新增".concat(t.energyName,"表"),e.modal.title="新增".concat(t.energyName,"表"),Array.isArray(e.modal.formCfg.fields)&&(e.modal.formCfg.fields.forEach((function(e){"id"===e.field?e.options.config.params.meterType=t.meterType:"expenseOptionId"===e.field&&(e.options.config.params.chargeType=t.meterType)})),e.meterType=t.meterType),e}));n.buttons=i}})):a&&(this.buttons=this.buttonsCfg.data)},getTableColumns:function(){var t,e,n=this,o=Boolean(null===(t=this.columnsCfg)||void 0===t||null===(t=t.apiCfg)||void 0===t||null===(t=t.config)||void 0===t?void 0:t.url),a=(null===(e=this.columnsCfg)||void 0===e?void 0:e.data)&&Array.isArray(this.columnsCfg.data);if(!o&&!a)throw new Error("表头未正确配置，缺少请求Api 或 硬编码数据！");o?Object(l["a"])(this.columnsCfg.apiCfg.config).then((function(t){return n.columns=c(t)})):a&&(this.columns=this.columnsCfg.data)}}},f=d,m=(n("a0cc"),n("2877")),b=Object(m["a"])(f,o,a,!1,null,"2fa0215e",null);e["default"]=b.exports},"8fe1":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n("5530"),a=(n("4de4"),n("7db0"),n("d81d"),n("b64b"),n("d3b7"),n("159b"),n("6d74"));function i(t,e){var n=t.filter((function(t){return t.options})),i={};return n.forEach((function(t){i[t.field]=a[t.options]||[]})),e.map((function(t){var e=Object(o["a"])({},t);return Object.keys(e).forEach((function(t){if(i[t]){var n=i[t].find((function(n){return n.value==e[t]}));e[t]=n?n.label:e[t]}})),e}))}},a0cc:function(t,e,n){"use strict";n("36da")},c034:function(t,e,n){}}]);